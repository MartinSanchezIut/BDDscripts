//AJOUTER DES INSERT INTONPOUR ARRANGER NOS REQUÊTES




Requêtes pour la vente de tickets :


Requête 1 :   


Quel est le montant total des billets vendus par gare de départ en fonction de la saison et du mois ?


SELECT ID_GARE_DEPART, SAISON, MOIS, SUM(PRIX)
FROM TICKET JOIN DATE_DATE ON TICKET.ID_DATE = DATE_DATE.ID_DATE
GROUP BY ID_GARE_DEPART, SAISON, MOIS;
               
Requête 2 : 


Prix total des billets vendus pour chaque trajet (gare de départ et d’arrivée) en fonction du mois


SELECT GARE_DEPART, GARE_ARRIVEE, MOIS, SUM(prix) FROM TICKET JOIN GARE ON TICKET.ID_GARE_DEPART=GARE.ID_GARE JOIN GARE ON TICKET.ID_GARE_ARRIVEE=GARE.ID_GARE JOIN DATE_DATE ON TICKET.DATE_DATE.ID_DATE=DATE.DATE.ID_DATE
GROUP BY GARE_DEPART, GARE_ARRIVEE, MOIS;




Requête 3 :


Quel est le prix moyen d'un ticket pour un trajet en fonction du type de train emprunté ?


Est-ce que l'on peut utiliser le trajet de cette façon ?
//TODO est-ce que je laisse le ROLL UP ? Il donne quoi exactement


SELECT ID_GARE_DEPART, ID_GARE_ARRIVEE, TYPE_TRAIN, AVG(PRIX)
FROM TICKET JOIN TRAIN ON TICKET.ID_TRAIN=TRAIN.ID_TRAIN
GROUP BY ROLL UP(ID_GARE_DEPART, ID_GARE_ARRIVEE, TYPE_TRAIN)


Requête 4 : utiliser les promotions


//EXEMPLE TICKETS À 1€ est-ce que l’opération a marché cet été ?


Le nombre de tickets vendus pour une certaine promotion ou une certaine carte en fonction des gares ou des régions et des années


Requête 5 : 
//QUESTION PROF


Nombre de ticket vendus à des jeunes n’ayant ps la carte alors qu’ils auraient pu pour chaque trajet


SELECT 


Est-ce qu’on peut faire une requête COUNT par trajet pour trier les voyageurs en fonction de leur âge, sans utiliser la mesure prix


SE




Requête 6 :


//TODO AJOUTER des voyageurs pour un meme train avec ou non des promotions
Rajouter un having count pour enlever les trajets ou il y a peu de voyageurs (realité)


Pourcentage du nombre de tickets vendus avec une promotion sur chaque trajet aujourd’hui




Requêtes pour l'occupation des trains : 


ATTENTION VOIR COURS SNAPSHOT ON PEUT PAS DEMANDER N IMPORTE QUOI EN FONCTION DE SI LA MESURE EST ADDITIVE OU NON
On va dire qu'on enregistre chaque jour (chaque semaine ?)
//TODO on devrait pas ajouter une condition pour la date, pour sélectionner les enregistrements d'ajd ?


Requête 1 :


Quel est le taux d'occupation de chaque trajet en fonction du type de train utilisé aujourd'hui (cette semaine?) ? 
//TODO ??? ROLL UP donne quoi exactement 


SELECT 
COALESCE(ID_GARE_DEPART, "TOUTES LES GARES DE DEPARTS") AS GARE_DEPART,
COALESCE(ID_GARE_D_ARRIVEE, "TOUTES LES GARDES D'ARRIVEES) AS GARE_ARRIVEE,
COALESCE(TYPE_TRAIN, "TOUS LES TYPES DE TRAINS") AS TYPES_TRAINS,
TAUX_OCCUPATION AS TAUX_OCCUPATION


FROM TRAJET JOIN TRAIN ON TRAJET.ID_TRAIN = TRAIN.ID_TRAIN


GROUP BY ROLL UP(GARE_DEPART, GARE_D_ARRIVEE, TYPE_TRAIN);


Requête 2 :


Quels est le taux d'occupation moyen des trains au départ de chaque département et chaque ville aujourd'hui ?
On va afficher le taux d'occupation moyen pour chaque département et chaque ville de ce département, 
On pourra voir quels départements et quelles villes précisément ont les trains au départ qui sont les moins bien remplis (la moyenne sera la plus basse)


SELECT DEPARTEMENT_GARE, VILLE_GARE, AVG(TAUX_OCCUPATION)
FROM TRAJET JOIN GARE ON TRAJET.ID_GARE_DEPART = GARE.ID_GARE 
GROUP BY DEPARTEMENT_GARE, VILLE_GARE;


Requête 3 :


//TODO Ajouter des valeurs


Le taux d’occupation pour chaque trajet aux différentes heures de la journée 


SELECT GARE_DEPART, GARE_ARRIVE, HEURES, TAUX_OCCUPATION
FROM TRAJET JOIN DATE_TIME on TRAJET.ID_TIME=DATE_TIME.ID_TIME
GROUP GARE_DEPART, GARE_ARRIVE, HEURES;


//TODO GROUP BY va pas marcher je crois


Requête 4 :


Quels est le taux d'occupation moyen des trains en gare d’arrivée de chaque département et chaque ville aujourd'hui ?


SELECT GARE_ARRIVEE, CODE_DEPARTEMENT_GARE, DEPARTEMENT_GARE, VILLE_GARE, TAUX_OCCUPATION 
FROM TRAJET JOIN GARE ON TRAJET.ID_GARE_DEPART = GARE.ID_DEPART
GROUP BY GARE_ARRIVEE, CODE_DEPARTEMENT_GARE, DEPARTEMENT_GARE, VILLE_GARE